---
import Layout from '../layouts/Layout.astro';
import '../styles/global.css';
import yaml from 'js-yaml';
import membersRaw from '../data/members.yml?raw';
import EuropeMap from '../components/EuropeMap.astro';

const members = yaml.load(membersRaw) as { given_name: string; surname: string; affiliation: string; country: string; roles: string[] }[];
const fellowCount = members.filter(m => m.roles.includes('fellow')).length;
const juniorCount = members.filter(m => m.roles.includes('junior-fellow')).length;
const countries = [...new Set(members.map(m => m.country))];
const countryCount = countries.length;
---

<Layout title="EuCAIF ‚Äì European Coalition for AI in Fundamental Physics">

<!-- NAVIGATION -->
<nav id="navbar">
  <a href="#" class="nav-logo">
    <img src="/eucaif.org/images/eucaif-logo-icon.png" alt="EuCAIF" width="36" height="36" style="border-radius:50%; display:block;" />
    EuCAIF
  </a>
  <div class="nav-links">
    <a href="#subfields">Research</a>
    <a href="#about">About</a>
    <a href="/eucaif.org/community/">Community</a>
    <a href="#conference">Conference</a>
    <a href="#publications">Publications</a>
    <a href="#blog">News</a>
    <a href="#join" class="nav-cta">Get Involved</a>
  </div>
  <button class="hamburger" aria-label="Menu">
    <span></span><span></span><span></span>
  </button>
</nav>

<!-- HERO -->
<section class="hero">
  <canvas id="particle-canvas"></canvas>
  <div class="hero-gradient"></div>
  <div class="hero-content">
    <div class="hero-badge">
      <span class="pulse"></span>
      EuCAIFCon 2026 ‚Äî Heidelberg ‚Äî August 24‚Äì28
    </div>
    <h1>AI at the frontier of <em>fundamental physics</em></h1>
    <p class="hero-sub">
      A European cross-disciplinary coalition advancing AI methods for particle physics, cosmology, gravitational waves, and beyond.
    </p>
    <div class="hero-actions">
      <a href="#join" class="btn-primary">Get Involved</a>
      <a href="#about" class="btn-secondary">Learn more</a>
    </div>
  </div>
  <div class="stats-bar">
    <div class="stat">
      <div class="stat-number" data-target={fellowCount}>0</div>
      <div class="stat-label">Fellows</div>
    </div>
    <div class="stat">
      <div class="stat-number" data-target={juniorCount}>0</div>
      <div class="stat-label">Junior Fellows</div>
    </div>
    <div class="stat">
      <div class="stat-number" data-target={countryCount}>0</div>
      <div class="stat-label">Countries</div>
    </div>
    <div class="stat">
      <div class="stat-number" data-target="1200" data-suffix="+">0</div>
      <div class="stat-label">AI publications / year</div>
    </div>
  </div>
</section>

<!-- SUBFIELDS -->
<section id="subfields">
  <div class="section-container">
    <div class="reveal">
      <div class="section-label">Research Domains</div>
      <h2 class="section-title">Across the frontiers of<br>fundamental physics</h2>
      <p class="section-desc">
        Shared challenges across subfields ‚Äî from modeling complex datasets to simulation-based inference ‚Äî demand AI methods developed with physics principles at their core.
      </p>
    </div>
    <div class="subfields-grid reveal reveal-delay-2">
      <div class="subfield-card">
        <div class="subfield-overlay" style="background-image: url('/eucaif.org/images/particle-tracks.jpg');"></div>
        <h3>Particle Physics</h3>
        <p>Unlocking the secrets of the tiniest building blocks with AI-driven analysis of collider data and beyond-standard-model searches.</p>
      </div>
      <div class="subfield-card">
        <div class="subfield-overlay" style="background-image: url('/eucaif.org/images/cosmology.png');"></div>
        <h3>Cosmology</h3>
        <p>Investigating the origins and evolution of the universe with machine learning on the grandest observational scales.</p>
      </div>
      <div class="subfield-card">
        <div class="subfield-overlay" style="background-image: url('/eucaif.org/images/gravity-waves.jpg');"></div>
        <h3>Gravitational Waves</h3>
        <p>Listening to spacetime ripples with neural networks that detect and characterize the most violent cosmic events.</p>
      </div>
      <div class="subfield-card">
        <div class="subfield-overlay" style="background-image: url('/eucaif.org/images/theoretical-physics.png');"></div>
        <h3>Theoretical Physics</h3>
        <p>Crafting mathematical frameworks with AI-augmented discovery of symmetries, dualities, and new physical laws.</p>
      </div>
      <div class="subfield-card">
        <div class="subfield-overlay" style="background-image: url('/eucaif.org/images/nuclear-physics.png');"></div>
        <h3>Nuclear Physics</h3>
        <p>Studying atomic nuclei to understand the forces that power stars, with ML models for complex many-body quantum systems.</p>
      </div>
      <div class="subfield-card">
        <div class="subfield-overlay" style="background-image: url('/eucaif.org/images/astroparticles.jpg');"></div>
        <h3>Astroparticle Physics</h3>
        <p>Exploring cosmic rays, neutrinos, and dark matter with AI pipelines processing vast multi-messenger datasets.</p>
      </div>
      <div class="subfield-card">
        <div class="subfield-overlay" style="background-image: url('/eucaif.org/images/accelerator-physics.png');"></div>
        <h3>Accelerator Physics</h3>
        <p>Pushing the frontiers of beam optimization and detector design with reinforcement learning and fast surrogate models.</p>
      </div>
    </div>
  </div>
</section>

<!-- ABOUT -->
<section id="about" class="about-section">
  <div class="section-container">
    <div class="about-grid">
      <div class="about-visual reveal" style="background: transparent; border: none;">
        <EuropeMap highlightedCountries={countries} />
      </div>
      <div class="about-text reveal reveal-delay-2">
        <div class="section-label">Purpose & Scope</div>
        <h2>Science-specific AI for discoveries beyond classical methods</h2>
        <p>
          AI and modern machine learning are transforming fundamental physics research. Common challenges ‚Äî modeling complex datasets, scalability to high-dimensional parameter spaces, fast emulators, and simulation-based inference ‚Äî highlight AI's transformative potential when methods are developed with physics principles at their core.
        </p>
        <p>
          EuCAIF creates a community for developers of specialized methods that incorporate robustness, uncertainty estimation, scientific explainability, and fundamental understanding of physics principles.
        </p>
        <div class="about-highlights">
          <div class="highlight-item">
            <h4>Cross-disciplinary</h4>
            <p>Methods that bridge particle physics, cosmology, and gravitational waves</p>
          </div>
          <div class="highlight-item">
            <h4>Uncertainty-aware</h4>
            <p>AI with built-in robustness and calibrated confidence</p>
          </div>
          <div class="highlight-item">
            <h4>Explainable</h4>
            <p>Scientific interpretability at the core, not as afterthought</p>
          </div>
          <div class="highlight-item">
            <h4>Community-driven</h4>
            <p>Open methods, shared challenges, collaborative research</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CONFERENCE -->
<section id="conference" class="conference-section">
  <div class="section-container">
    <div class="conference-banner reveal" style="background-image: url('/eucaif.org/images/conference.jpg');">
      <div class="conf-info">
        <div class="conf-year">Next Conference</div>
        <h2>EuCAIFCon 2026</h2>
        <p>The annual European Conference for AI in Fundamental Physics. Sessions centered on AI methods and themes, cross-disciplinary regarding the scientific questions.</p>
        <div class="conf-meta">
          <div class="conf-meta-item">
            <span class="conf-meta-icon">üìç</span> Heidelberg, Germany
          </div>
          <div class="conf-meta-item">
            <span class="conf-meta-icon">üìÖ</span> August 24 ‚Äì 28, 2026
          </div>
        </div>
        <div class="conf-actions">
          <a href="https://indico.physi.uni-heidelberg.de/event/1277/" class="btn-primary" target="_blank">Register Now</a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- PUBLICATIONS -->
<section id="publications" class="publications-section">
  <div class="section-container">
    <div class="reveal">
      <div class="section-label">Latest Research</div>
      <h2 class="section-title">Publications</h2>
      <p class="section-desc">
        Recent highlights from across the EuCAIF community ‚Äî simulation-based inference, generative models, equivariant networks, and more.
      </p>
    </div>
    <div class="pub-list">
      <div class="pub-item reveal reveal-delay-1">
        <span class="pub-tag">Particle</span>
        <div class="pub-content">
          <h4>Simulation-based inference for particle physics collider searches</h4>
          <p>Cranmer, K. et al. ¬∑ Physical Review D ¬∑ 2025</p>
        </div>
        <a class="pub-link" href="#">arXiv ‚Üí</a>
      </div>
      <div class="pub-item reveal reveal-delay-2">
        <span class="pub-tag cosmo">Cosmology</span>
        <div class="pub-content">
          <h4>Neural posterior estimation for cosmic shear power spectra</h4>
          <p>Lemos, P. et al. ¬∑ JCAP ¬∑ 2025</p>
        </div>
        <a class="pub-link" href="#">arXiv ‚Üí</a>
      </div>
      <div class="pub-item reveal reveal-delay-3">
        <span class="pub-tag gw">Grav. Waves</span>
        <div class="pub-content">
          <h4>Deep learning for LISA data: source separation and parameter estimation</h4>
          <p>Dax, M. et al. ¬∑ Physical Review Letters ¬∑ 2025</p>
        </div>
        <a class="pub-link" href="#">arXiv ‚Üí</a>
      </div>
      <div class="pub-item reveal reveal-delay-4">
        <span class="pub-tag theory">Theory</span>
        <div class="pub-content">
          <h4>Equivariant neural networks for lattice gauge theory</h4>
          <p>Boyda, D. et al. ¬∑ Machine Learning: Science & Technology ¬∑ 2025</p>
        </div>
        <a class="pub-link" href="#">arXiv ‚Üí</a>
      </div>
      <div class="pub-item reveal">
        <span class="pub-tag nuclear">Nuclear</span>
        <div class="pub-content">
          <h4>Variational Monte Carlo with normalizing flows for nuclear structure</h4>
          <p>Adams, C. et al. ¬∑ Physical Review C ¬∑ 2025</p>
        </div>
        <a class="pub-link" href="#">arXiv ‚Üí</a>
      </div>
    </div>
    <div style="text-align:center; margin-top: 2.5rem;" class="reveal">
      <a href="#" class="btn-secondary">View all publications ‚Üí</a>
    </div>
  </div>
</section>

<!-- BLOG / NEWS -->
<section id="blog">
  <div class="section-container">
    <div class="reveal">
      <div class="section-label">News & Highlights</div>
      <h2 class="section-title">From the community</h2>
      <p class="section-desc">
        Updates, highlights, and perspectives from across the EuCAIF network.
      </p>
    </div>
    <div class="blog-grid">
      <div class="blog-card reveal reveal-delay-1">
        <div class="blog-image">
          <div class="blog-image-pattern"></div>
        </div>
        <div class="blog-body">
          <div class="blog-date">Jan 2026</div>
          <h3>EuCAIFCon 2025 Proceedings now published in SciPost</h3>
          <p>The full proceedings of EuCAIFCon 2025 Sardinia are now available, featuring 47 contributions across all subfields.</p>
        </div>
      </div>
      <div class="blog-card reveal reveal-delay-2">
        <div class="blog-image" style="background: linear-gradient(135deg, #1a1a2e, #16213e);">
          <div class="blog-image-pattern"></div>
        </div>
        <div class="blog-body">
          <div class="blog-date">Dec 2025</div>
          <h3>New working group on Foundation Models for Physics</h3>
          <p>EuCAIF launches a dedicated working group exploring how large-scale foundation models can accelerate scientific discovery.</p>
        </div>
      </div>
      <div class="blog-card reveal reveal-delay-3">
        <div class="blog-image" style="background: linear-gradient(135deg, #0f0f1a, #1a0f2e);">
          <div class="blog-image-pattern"></div>
        </div>
        <div class="blog-body">
          <div class="blog-date">Nov 2025</div>
          <h3>EuCAIF members win NeurIPS spotlight for physics-informed diffusion models</h3>
          <p>A cross-institutional collaboration develops score-based generative models with exact symmetry guarantees.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CTA -->
<section id="join" class="cta-section">
  <div class="section-container reveal">
    <h2>Shape the future of<br><em>AI in physics</em></h2>
    <p>Connect with a growing European community of researchers developing the next generation of AI methods for fundamental physics.</p>
    <div class="hero-actions" style="justify-content: center;">
      <a href="mailto:info@eucaif.org" class="btn-primary">Get Involved</a>
      <a href="#" class="btn-secondary">Read the Charter</a>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <div class="footer-inner">
    <div class="footer-text">¬© 2026 EuCAIF ‚Äî European Coalition for AI in Fundamental Physics</div>
    <div class="footer-links">
      <a href="#">GitHub</a>
      <a href="#">Contact</a>
      <a href="#">Privacy</a>
    </div>
  </div>
</footer>

<script>
// PARTICLES IN A BOX ‚Äî periodic BCs, repulsive interparticle, attractive mouse
const canvas = document.getElementById('particle-canvas') as HTMLCanvasElement;
const ctx = canvas.getContext('2d')!;
let mouse = { x: null as number | null, y: null as number | null, active: false };

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  for (const p of particles) {
    p.x = ((p.x % canvas.width) + canvas.width) % canvas.width;
    p.y = ((p.y % canvas.height) + canvas.height) % canvas.height;
  }
}

const PARTICLE_COUNT = 200;
const REPULSION_STRENGTH = 80;
const REPULSION_RANGE = 80;
const MOUSE_STRENGTH = 3500;
const MOUSE_RANGE = 300;
const DAMPING = 0.94;
const MAX_SPEED = 4;
const DT = 0.167;

const particles: any[] = [];

class Particle {
  x: number;
  y: number;
  vx: number;
  vy: number;
  radius: number;
  hue: string;
  color: string;
  glowColor: string;

  constructor() {
    this.x = Math.random() * (window.innerWidth || 1200);
    this.y = Math.random() * (window.innerHeight || 800);
    this.vx = (Math.random() - 0.5) * 1.5;
    this.vy = (Math.random() - 0.5) * 1.5;
    this.radius = Math.random() * 1.2 + 1.0;
    const r = Math.random();
    if (r < 0.5) {
      this.hue = 'blue';
      this.color = `rgba(56, 176, 230, 0.8)`;
      this.glowColor = `rgba(26, 143, 196, `;
    } else if (r < 0.8) {
      this.hue = 'cyan';
      this.color = `rgba(80, 200, 240, 0.7)`;
      this.glowColor = `rgba(56, 176, 230, `;
    } else {
      this.hue = 'silver';
      this.color = `rgba(180, 190, 200, 0.7)`;
      this.glowColor = `rgba(212, 165, 67, `;
    }
  }
}

for (let i = 0; i < PARTICLE_COUNT; i++) {
  particles.push(new Particle());
}

resize();
window.addEventListener('resize', resize);

document.addEventListener('mousemove', (e) => {
  const rect = canvas.getBoundingClientRect();
  mouse.x = e.clientX - rect.left;
  mouse.y = e.clientY - rect.top;
  mouse.active = e.clientY < rect.bottom && e.clientY > rect.top;
});
document.addEventListener('mouseleave', () => {
  mouse.active = false;
});

function periodicDelta(d: number, L: number) {
  if (d > L * 0.5) return d - L;
  if (d < -L * 0.5) return d + L;
  return d;
}

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const W = canvas.width;
  const H = canvas.height;

  for (let i = 0; i < particles.length; i++) {
    const pi = particles[i];
    let fx = 0, fy = 0;

    for (let j = 0; j < particles.length; j++) {
      if (i === j) continue;
      const pj = particles[j];

      let dx = periodicDelta(pi.x - pj.x, W);
      let dy = periodicDelta(pi.y - pj.y, H);
      const r2 = dx * dx + dy * dy;
      const r = Math.sqrt(r2);

      if (r < REPULSION_RANGE && r > 0.5) {
        const force = REPULSION_STRENGTH / (r2 + 100);
        fx += (dx / r) * force;
        fy += (dy / r) * force;
      }
    }

    if (mouse.active && mouse.x !== null && mouse.y !== null) {
      let dx = periodicDelta(mouse.x - pi.x, W);
      let dy = periodicDelta(mouse.y - pi.y, H);
      const r2 = dx * dx + dy * dy;
      const r = Math.sqrt(r2);

      if (r < MOUSE_RANGE && r > 2) {
        const force = MOUSE_STRENGTH / (r2 + 500);
        fx += (dx / r) * force;
        fy += (dy / r) * force;
      }
    }

    pi.vx += (Math.random() - 0.5) * 0.15;
    pi.vy += (Math.random() - 0.5) * 0.15;

    pi.vx += fx * DT;
    pi.vy += fy * DT;

    pi.vx *= DAMPING;
    pi.vy *= DAMPING;

    const speed = Math.sqrt(pi.vx * pi.vx + pi.vy * pi.vy);
    if (speed > MAX_SPEED) {
      pi.vx = (pi.vx / speed) * MAX_SPEED;
      pi.vy = (pi.vy / speed) * MAX_SPEED;
    }

    pi.x += pi.vx * DT;
    pi.y += pi.vy * DT;

    pi.x = ((pi.x % W) + W) % W;
    pi.y = ((pi.y % H) + H) % H;
  }

  for (let i = 0; i < particles.length; i++) {
    for (let j = i + 1; j < particles.length; j++) {
      let dx = periodicDelta(particles[i].x - particles[j].x, W);
      let dy = periodicDelta(particles[i].y - particles[j].y, H);
      const dist = Math.sqrt(dx * dx + dy * dy);

      if (dist < 100) {
        const closeness = 1 - dist / 100;
        const alpha = closeness * closeness * 0.45;
        const width = closeness * closeness * 2.5 + 0.3;
        if (Math.abs(particles[i].x - particles[j].x) < 100 &&
            Math.abs(particles[i].y - particles[j].y) < 100) {
          ctx.beginPath();
          ctx.moveTo(particles[i].x, particles[i].y);
          ctx.lineTo(particles[j].x, particles[j].y);
          ctx.strokeStyle = `rgba(26, 143, 196, ${alpha})`;
          ctx.lineWidth = width;
          ctx.stroke();
        }
      }
    }
  }

  for (const p of particles) {
    const speed = Math.sqrt(p.vx * p.vx + p.vy * p.vy);
    const excitement = Math.min(1, speed / MAX_SPEED);

    if (excitement > 0.3) {
      const glowR = p.radius + excitement * 6;
      const grad = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, glowR);
      grad.addColorStop(0, p.glowColor + `${excitement * 0.3})`);
      grad.addColorStop(1, p.glowColor + `0)`);
      ctx.beginPath();
      ctx.arc(p.x, p.y, glowR, 0, Math.PI * 2);
      ctx.fillStyle = grad;
      ctx.fill();
    }

    ctx.beginPath();
    ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
    ctx.fillStyle = p.color;
    ctx.fill();
  }

  if (mouse.active && mouse.x !== null && mouse.y !== null) {
    const grad = ctx.createRadialGradient(mouse.x, mouse.y, 0, mouse.x, mouse.y, 60);
    grad.addColorStop(0, 'rgba(26, 143, 196, 0.06)');
    grad.addColorStop(1, 'rgba(26, 143, 196, 0)');
    ctx.beginPath();
    ctx.arc(mouse.x, mouse.y, 60, 0, Math.PI * 2);
    ctx.fillStyle = grad;
    ctx.fill();
  }

  requestAnimationFrame(animate);
}
animate();

// NAV SCROLL
const navbar = document.getElementById('navbar')!;
window.addEventListener('scroll', () => {
  navbar.classList.toggle('scrolled', window.scrollY > 50);
});

// SCROLL REVEAL
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
    }
  });
}, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });

document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

// COUNTER ANIMATION
function animateCounters() {
  document.querySelectorAll('.stat-number').forEach(el => {
    const target = parseInt((el as HTMLElement).dataset.target!);
    const suffix = (el as HTMLElement).dataset.suffix || '';
    const duration = 2000;
    const start = performance.now();
    function update(now: number) {
      const elapsed = now - start;
      const progress = Math.min(elapsed / duration, 1);
      const eased = 1 - Math.pow(1 - progress, 3);
      el.textContent = Math.floor(target * eased) + suffix;
      if (progress < 1) requestAnimationFrame(update);
    }
    requestAnimationFrame(update);
  });
}

const statsObserver = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      animateCounters();
      statsObserver.disconnect();
    }
  });
}, { threshold: 0.5 });
const statsBar = document.querySelector('.stats-bar');
if (statsBar) statsObserver.observe(statsBar);
</script>

</Layout>
