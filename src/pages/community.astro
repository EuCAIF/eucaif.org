---
import Layout from '../layouts/Layout.astro';
import '../styles/global.css';
import yaml from 'js-yaml';
import membersRaw from '../data/members.yml?raw';

const members = yaml.load(membersRaw) as { given_name: string; surname: string; affiliation: string; country: string; roles: string[] }[];

function flag(code: string) {
  return String.fromCodePoint(...[...code.toUpperCase()].map(c => 0x1F1E6 + c.charCodeAt(0) - 65));
}

const sorted = [...members].sort((a, b) => a.surname.localeCompare(b.surname));
const board = sorted.filter(m => m.roles.includes('board'));
const advisory = sorted.filter(m => m.roles.includes('advisory'));
const fellows = sorted.filter(m => m.roles.includes('fellow'));
const juniorFellows = sorted.filter(m => m.roles.includes('junior-fellow'));
---

<Layout title="Community – EuCAIF">

<nav id="navbar" class="scrolled">
  <a href="/eucaif.org/" class="nav-logo">
    <img src="/eucaif.org/images/eucaif-logo-icon.png" alt="EuCAIF" width="36" height="36" style="border-radius:50%; display:block;" />
    EuCAIF
  </a>
  <div class="nav-links">
    <a href="/eucaif.org/#subfields">Research</a>
    <a href="/eucaif.org/#about">About</a>
    <a href="/eucaif.org/community/">Community</a>
    <a href="/eucaif.org/#conference">Conference</a>
    <a href="/eucaif.org/#publications">Publications</a>
    <a href="/eucaif.org/#blog">News</a>
    <a href="/eucaif.org/#join" class="nav-cta">Get Involved</a>
  </div>
  <button class="hamburger" aria-label="Menu">
    <span></span><span></span><span></span>
  </button>
</nav>

<section style="padding-top: 8rem;">
  <div class="section-container">
    <div class="section-label">Our Community</div>

    <h2 class="section-title">Management Board</h2>
    <p class="section-desc">{board.length} members steering the coalition.</p>
    <div class="members-grid">
      {board.map(m => (
        <div class="member-card">
          <h4><span class="member-flag">{flag(m.country)}</span> {m.given_name} {m.surname}</h4>
          <p>{m.affiliation}</p>
        </div>
      ))}
    </div>

    <h2 class="section-title" style="margin-top: 4rem;">International Advisory Board</h2>
    <p class="section-desc">{advisory.length} external advisors.</p>
    <div class="members-grid">
      {advisory.map(m => (
        <div class="member-card">
          <h4><span class="member-flag">{flag(m.country)}</span> {m.given_name} {m.surname}</h4>
          <p>{m.affiliation}</p>
        </div>
      ))}
    </div>

    <h2 class="section-title" style="margin-top: 4rem;">Fellows</h2>
    <p class="section-desc">{fellows.length} Fellows from across Europe and beyond.</p>
    <div class="members-grid">
      {fellows.map(m => (
        <div class="member-card">
          <h4><span class="member-flag">{flag(m.country)}</span> {m.given_name} {m.surname}</h4>
          <p>{m.affiliation}</p>
        </div>
      ))}
    </div>

    <h2 class="section-title" style="margin-top: 4rem;">Junior Fellows</h2>
    <p class="section-desc">{juniorFellows.length} Junior Fellows.</p>
    <div class="members-grid">
      {juniorFellows.map(m => (
        <div class="member-card">
          <h4><span class="member-flag">{flag(m.country)}</span> {m.given_name} {m.surname}</h4>
          <p>{m.affiliation}</p>
        </div>
      ))}
    </div>
  </div>
</section>

<footer>
  <div class="footer-inner">
    <div class="footer-text">© 2026 EuCAIF — European Coalition for AI in Fundamental Physics</div>
    <div class="footer-links">
      <a href="#">GitHub</a>
      <a href="#">Contact</a>
      <a href="#">Privacy</a>
    </div>
  </div>
</footer>

</Layout>
